Index: app/src/main/java/com/example/tinnhn/ui/main/PlaceholderFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.tinnhn.ui.main;\r\n\r\nimport android.animation.TimeAnimator;\r\nimport android.app.Dialog;\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.os.CountDownTimer;\r\nimport android.text.Editable;\r\nimport android.text.TextWatcher;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.AdapterView;\r\nimport android.widget.EditText;\r\nimport android.widget.ListView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.tinnhn.Friends;\r\nimport com.example.tinnhn.HoiThoai;\r\nimport com.example.tinnhn.HoiThoaiActivity;\r\nimport com.example.tinnhn.Message;\r\nimport com.example.tinnhn.MessageAdapter;\r\nimport com.example.tinnhn.R;\r\nimport com.example.tinnhn.TinNhanHienThi;\r\nimport com.example.tinnhn.taikhoan.HihNgNhanTrogMessArrLst;\r\nimport com.example.tinnhn.taikhoan.TaiKhoan;\r\nimport com.google.firebase.database.ChildEventListener;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\n\r\nimport java.util.ArrayList;\r\n\r\nimport static android.content.Context.MODE_PRIVATE;\r\nimport static com.example.tinnhn.HoiThoaiActivity.hoiThoaiAdapter;\r\nimport static com.example.tinnhn.MainActivity.hihNgNhanTrogMessArrLsts;\r\nimport static com.example.tinnhn.taikhoan.LoginActivity.dbFirebase;\r\n\r\n/**\r\n * A placeholder fragment containing a simple view.\r\n */\r\npublic class PlaceholderFragment extends Fragment {\r\n    private static final String ARG_SECTION_NUMBER = \"section_number\";\r\n    SharedPreferences sharedPreferences;\r\n    SharedPreferences.Editor editor;\r\n    private PageViewModel pageViewModel;\r\n    int vitri;\r\n    boolean clickcheck = false;\r\n    private DatabaseReference mDatabase;\r\n    public String NoiDung, TenUser;\r\n    ArrayList<TinNhanHienThi> messageArrayList;\r\n    MessageAdapter messageAdapter;\r\n    String EmailUser;\r\n    ArrayList<TinNhanHienThi> messageArrayList_Message1;\r\n    boolean check_search = false;\r\n\r\n    String TAG = \"PlaceholderFragment\";\r\n\r\n    public static PlaceholderFragment newInstance(int index) {\r\n        PlaceholderFragment fragment = new PlaceholderFragment();\r\n        Bundle bundle = new Bundle();\r\n        bundle.putInt(ARG_SECTION_NUMBER, index);\r\n        fragment.setArguments(bundle);\r\n        return fragment;\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n//        pageViewModel = ViewModelProviders.of(this).get(PageViewModel.class);\r\n//        int index = 1;\r\n//        if (getArguments() != null) {\r\n//            index = getArguments().getInt(ARG_SECTION_NUMBER);\r\n//        }\r\n//        pageViewModel.setIndex(index);\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_main, container, false);\r\n        mDatabase = FirebaseDatabase.getInstance().getReference();\r\n\r\n        EditText tv_Search_TinNhan = view.findViewById(R.id.title);\r\n        ListView list_view_Message = view.findViewById(R.id.list_view_Message);\r\n        messageArrayList = new ArrayList<>();\r\n        messageArrayList_Message1 = new ArrayList<>();\r\n//        ArrayList<Friends> messageArrayList_check = new ArrayList<>();\r\n//        ArrayList<HoiThoai> messageArrayList_Message = new ArrayList<>();\r\n        messageAdapter = new MessageAdapter(getActivity(), R.layout.list_message_item, messageArrayList);\r\n        list_view_Message.setAdapter(messageAdapter);\r\n        sharedPreferences = getContext().getSharedPreferences(\"GhiNhoDangNhap\", MODE_PRIVATE);\r\n        editor = sharedPreferences.edit();\r\n        EmailUser = sharedPreferences.getString(\"tenTaiKhoan\", \"\");\r\n        TenUser = sharedPreferences.getString(\"tenUser\", \"\");\r\n\r\n        if (!check_search) {\r\n            hihNgNhanTrogMessArrLsts.clear();\r\n            mDatabase.child(\"TinNhan\").addChildEventListener(new ChildEventListener() {\r\n                @Override\r\n                public void onChildAdded(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n                    TinNhanHienThi message = snapshot.getValue(TinNhanHienThi.class);\r\n                    if (message.email_User.equals(EmailUser)) {\r\n                        String keyTinNhan = snapshot.getKey();\r\n                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.emailNguoiNhan, message.email_User, message.tenUser, message.tenNguoiGui));\r\n                        // lấy url hình từ mail người dùng\r\n                        LayUrlTuEmail(message.emailNguoiNhan);\r\n                        //\r\n                    }\r\n                    if (message.emailNguoiNhan.equals(EmailUser)) {\r\n                        String keyTinNhan = snapshot.getKey();\r\n                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.email_User, message.emailNguoiNhan, message.tenNguoiGui, message.tenUser));\r\n                        // lấy url hình từ mail người dùng\r\n                        LayUrlTuEmail(message.email_User);\r\n                        //\r\n                    }\r\n                    messageAdapter.notifyDataSetChanged();\r\n                }\r\n\r\n                @Override\r\n                public void onChildChanged(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n\r\n                }\r\n\r\n                @Override\r\n                public void onChildRemoved(@NonNull DataSnapshot snapshot) {\r\n\r\n                }\r\n\r\n                @Override\r\n                public void onChildMoved(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n\r\n                }\r\n\r\n                @Override\r\n                public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        list_view_Message.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView<?> adapterView, View view, int i, long l) {\r\n                Intent intent = new Intent(getActivity(), HoiThoaiActivity.class);\r\n                if (messageArrayList.get(i).email_User.equals(EmailUser)) {\r\n                    intent.putExtra(\"TenNguoiGui\", messageArrayList.get(i).tenUser);\r\n                } else if (messageArrayList.get(i).emailNguoiNhan.equals(EmailUser)) {\r\n                    intent.putExtra(\"TenNguoiGui\", messageArrayList.get(i).tenNguoiGui);\r\n                }\r\n                intent.putExtra(\"EmailNguoiGui\", messageArrayList.get(i).emailNguoiNhan);\r\n                startActivity(intent);\r\n//                container.removeView(view);\r\n            }\r\n        });\r\n        tv_Search_TinNhan.addTextChangedListener(new TextWatcher() {\r\n            @Override\r\n            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n                messageArrayList.clear();\r\n                messageAdapter.notifyDataSetChanged();\r\n                mDatabase.child(\"TinNhan\").addChildEventListener(new ChildEventListener() {\r\n                    @Override\r\n                    public void onChildAdded(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n                        TinNhanHienThi message = snapshot.getValue(TinNhanHienThi.class);\r\n                        if (tv_Search_TinNhan.getText().toString().contains(message.tenUser) && message.tenUser.equals(TenUser)\r\n                                || tv_Search_TinNhan.getText().toString().contains(message.tenUser) && message.tenNguoiGui.equals(TenUser)\r\n                                || tv_Search_TinNhan.getText().toString().contains(message.tenNguoiGui) && message.email_User.equals(EmailUser)) {\r\n                            String keyTinNhan = snapshot.getKey();\r\n                            messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.emailNguoiNhan, message.email_User, message.tenUser, message.tenNguoiGui));\r\n                        }\r\n                        if (tv_Search_TinNhan.getText().toString().equals(\"\")) {\r\n                            if (message.email_User.equals(EmailUser)) {\r\n                                String keyTinNhan = snapshot.getKey();\r\n                                messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.emailNguoiNhan, message.email_User, message.tenUser, message.tenNguoiGui));\r\n                            }\r\n                            if (message.emailNguoiNhan.equals(EmailUser)) {\r\n                                String keyTinNhan = snapshot.getKey();\r\n                                messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.email_User, message.emailNguoiNhan, message.tenNguoiGui, message.tenUser));\r\n                            }\r\n                            check_search = true;\r\n                        }\r\n                        messageAdapter.notifyDataSetChanged();\r\n                    }\r\n\r\n                    @Override\r\n                    public void onChildChanged(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n\r\n                    }\r\n\r\n                    @Override\r\n                    public void onChildRemoved(@NonNull DataSnapshot snapshot) {\r\n\r\n                    }\r\n\r\n                    @Override\r\n                    public void onChildMoved(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n\r\n                    }\r\n\r\n                    @Override\r\n                    public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                    }\r\n                });\r\n            }\r\n\r\n            @Override\r\n            public void afterTextChanged(Editable editable) {\r\n\r\n            }\r\n        });\r\n        // code của trường, hàm lấy url hình từ email người nhận\r\n//        final Dialog dialog = new Dialog(getContext());\r\n//        dialog.setContentView(R.layout.dialog_loading);\r\n//        dialog.show();\r\n        new CountDownTimer(1300, 100) {\r\n            @Override\r\n            public void onTick(long millisUntilFinished) {\r\n            }\r\n\r\n            @Override\r\n            public void onFinish() {\r\n//                dialog.dismiss();\r\n                if (hihNgNhanTrogMessArrLsts.size() != 0) {\r\n                    for (int i = 0; i < hihNgNhanTrogMessArrLsts.size(); i++) {\r\n                        Log.d(TAG, \"235: \" + hihNgNhanTrogMessArrLsts.get(i).getUrlHinhNguoiNhan());\r\n                    }\r\n                } else Log.d(TAG, \"238: \" + hihNgNhanTrogMessArrLsts.size());\r\n//                LayDanhSachUrlTuEmailNguoiNhan(messageArrayList);\r\n            }\r\n        }.start();\r\n        //\r\n        return view;\r\n    }\r\n\r\n    // lấy url hình từ mail người dùng\r\n    private void LayUrlTuEmail(String emailNguoiNhan) {\r\n//        mDatabase.child(\"TaiKhoan\").addChildEventListener(new ChildEventListener() {\r\n//            @Override\r\n//            public void onChildAdded(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//                TaiKhoan taiKhoan = snapshot.getValue(TaiKhoan.class);\r\n//                if (taiKhoan.getEmail().equals(emailNguoiNhan)) {\r\n//                    hihNgNhanTrogMessArrLsts.add(new HihNgNhanTrogMessArrLst(emailNguoiNhan, taiKhoan.getHinhDaiDien()));\r\n//                }\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onChildChanged(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onChildRemoved(@NonNull DataSnapshot snapshot) {\r\n//\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onChildMoved(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onCancelled(@NonNull DatabaseError error) {\r\n//\r\n//            }\r\n//        });\r\n    }\r\n    //\r\n\r\n//    1sec messageArrayList\r\n//            1sec hihNgNhanTrogMessArrLsts\r\n//                1sec messageArrayList\r\n\r\n//    private void LayDanhSachUrlTuEmailNguoiNhan(ArrayList<TinNhanHienThi> messageArrayList) {\r\n//        if (messageArrayList.size() != 0) {\r\n////            hihNgNhanTrogMessArrLsts.clear();\r\n//            for (int i = 0; i < messageArrayList.size(); i++) {\r\n////                dbFirebase.LayUrlHinhNguoiNhanTuEmail(messageArrayList.get(i).emailNguoiNhan);\r\n//                int finalI = i;\r\n//                mDatabase.child(\"TaiKhoan\").addChildEventListener(new ChildEventListener() {\r\n//                    @Override\r\n//                    public void onChildAdded(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//                        TaiKhoan taiKhoan = snapshot.getValue(TaiKhoan.class);\r\n//                        if (taiKhoan.getEmail().equals(messageArrayList.get(finalI).emailNguoiNhan)) {\r\n//                            hihNgNhanTrogMessArrLsts.add(new HihNgNhanTrogMessArrLst(messageArrayList.get(finalI).emailNguoiNhan, taiKhoan.getHinhDaiDien()));\r\n//                            Log.d(TAG, \"hihNgNhanTrogMessArrLsts: \" + hihNgNhanTrogMessArrLsts.size());\r\n//                        }\r\n//                    }\r\n//\r\n//                    @Override\r\n//                    public void onChildChanged(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//\r\n//                    }\r\n//\r\n//                    @Override\r\n//                    public void onChildRemoved(@NonNull DataSnapshot snapshot) {\r\n//\r\n//                    }\r\n//\r\n//                    @Override\r\n//                    public void onChildMoved(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//\r\n//                    }\r\n//\r\n//                    @Override\r\n//                    public void onCancelled(@NonNull DatabaseError error) {\r\n//\r\n//                    }\r\n//                });\r\n//\r\n//\r\n//            }\r\n//\r\n//        } else Log.e(TAG, \"LayDanhSachUrlTuEmailNguoiNhan: Danh sách tin nhắn trống\");\r\n////        Log.d(TAG, \"hihNgNhanTrogMessArrLsts: \" + hihNgNhanTrogMessArrLsts.size());\r\n//\r\n//    }\r\n\r\n//    public void GoiDanhSachTinNhan() {\r\n//        mDatabase = FirebaseDatabase.getInstance().getReference();\r\n//        messageArrayList.clear();\r\n//        messageAdapter.notifyDataSetChanged();\r\n//        mDatabase.child(\"TinNhan\").addChildEventListener(new ChildEventListener() {\r\n//            @Override\r\n//            public void onChildAdded(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//                TinNhanHienThi message = snapshot.getValue(TinNhanHienThi.class);\r\n//                messageArrayList_Message1.clear();\r\n//                messageArrayList_Message1.add(message);\r\n//                for (int i = 0; i < messageArrayList_Message1.size(); i++) {\r\n//                    if (messageArrayList_Message1.get(i).email_User.equals(EmailUser)) {\r\n//                        String keyTinNhan = snapshot.getKey();\r\n//                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, messageArrayList_Message1.get(i).message_User, messageArrayList_Message1.get(i).emailNguoiNhan, messageArrayList_Message1.get(i).email_User, messageArrayList_Message1.get(i).tenUser, messageArrayList_Message1.get(i).tenNguoiGui));\r\n//                    }\r\n//                    if (messageArrayList_Message1.get(i).emailNguoiNhan.equals(EmailUser)) {\r\n//                        String keyTinNhan = snapshot.getKey();\r\n//                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, messageArrayList_Message1.get(i).message_User, messageArrayList_Message1.get(i).email_User, messageArrayList_Message1.get(i).emailNguoiNhan, messageArrayList_Message1.get(i).tenNguoiGui, messageArrayList_Message1.get(i).tenUser));\r\n//                    }\r\n//                }\r\n//                messageAdapter.notifyDataSetChanged();\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onChildChanged(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onChildRemoved(@NonNull DataSnapshot snapshot) {\r\n//\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onChildMoved(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {\r\n//\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onCancelled(@NonNull DatabaseError error) {\r\n//\r\n//            }\r\n//        });\r\n//    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/tinnhn/ui/main/PlaceholderFragment.java	(revision 4f3bf44d5c5df6a37e923e90a593800fb057fc23)
+++ app/src/main/java/com/example/tinnhn/ui/main/PlaceholderFragment.java	(date 1606470159003)
@@ -101,50 +101,50 @@
         EmailUser = sharedPreferences.getString("tenTaiKhoan", "");
         TenUser = sharedPreferences.getString("tenUser", "");
 
-        if (!check_search) {
-            hihNgNhanTrogMessArrLsts.clear();
-            mDatabase.child("TinNhan").addChildEventListener(new ChildEventListener() {
-                @Override
-                public void onChildAdded(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {
-                    TinNhanHienThi message = snapshot.getValue(TinNhanHienThi.class);
-                    if (message.email_User.equals(EmailUser)) {
-                        String keyTinNhan = snapshot.getKey();
-                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.emailNguoiNhan, message.email_User, message.tenUser, message.tenNguoiGui));
-                        // lấy url hình từ mail người dùng
-                        LayUrlTuEmail(message.emailNguoiNhan);
-                        //
-                    }
-                    if (message.emailNguoiNhan.equals(EmailUser)) {
-                        String keyTinNhan = snapshot.getKey();
-                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.email_User, message.emailNguoiNhan, message.tenNguoiGui, message.tenUser));
-                        // lấy url hình từ mail người dùng
-                        LayUrlTuEmail(message.email_User);
-                        //
-                    }
-                    messageAdapter.notifyDataSetChanged();
-                }
-
-                @Override
-                public void onChildChanged(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {
-
-                }
-
-                @Override
-                public void onChildRemoved(@NonNull DataSnapshot snapshot) {
-
-                }
-
-                @Override
-                public void onChildMoved(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {
-
-                }
-
-                @Override
-                public void onCancelled(@NonNull DatabaseError error) {
-
-                }
-            });
-        }
+//        if (!check_search) {
+//            hihNgNhanTrogMessArrLsts.clear();
+//            mDatabase.child("TinNhan").addChildEventListener(new ChildEventListener() {
+//                @Override
+//                public void onChildAdded(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {
+//                    TinNhanHienThi message = snapshot.getValue(TinNhanHienThi.class);
+//                    if (message.email_User.equals(EmailUser)) {
+//                        String keyTinNhan = snapshot.getKey();
+//                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.emailNguoiNhan, message.email_User, message.tenUser, message.tenNguoiGui));
+//                        // lấy url hình từ mail người dùng
+//                        LayUrlTuEmail(message.emailNguoiNhan);
+//                        //
+//                    }
+//                    if (message.emailNguoiNhan.equals(EmailUser)) {
+//                        String keyTinNhan = snapshot.getKey();
+//                        messageArrayList.add(new TinNhanHienThi(keyTinNhan, message.message_User, message.email_User, message.emailNguoiNhan, message.tenNguoiGui, message.tenUser));
+//                        // lấy url hình từ mail người dùng
+//                        LayUrlTuEmail(message.email_User);
+//                        //
+//                    }
+//                    messageAdapter.notifyDataSetChanged();
+//                }
+//
+//                @Override
+//                public void onChildChanged(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {
+//
+//                }
+//
+//                @Override
+//                public void onChildRemoved(@NonNull DataSnapshot snapshot) {
+//
+//                }
+//
+//                @Override
+//                public void onChildMoved(@NonNull DataSnapshot snapshot, @Nullable String previousChildName) {
+//
+//                }
+//
+//                @Override
+//                public void onCancelled(@NonNull DatabaseError error) {
+//
+//                }
+//            });
+//        }
 
 
         list_view_Message.setOnItemClickListener(new AdapterView.OnItemClickListener() {
